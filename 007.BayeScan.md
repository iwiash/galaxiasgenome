## Using BayeScan to do a fenome scan using FST for loci that differ btwn mig and nonmig pops

First want to refilter VCF to remove the CHatham/Auck Islands pops and the msterious GB samples:
```
add code here - nesi gone down
just using vcftools again but with a new indivs to rm file
```

Then want to convert this new VCF to a Bayes file using PGDSpider3
```
GUI but this is what I did:

Input file: snpfiltered2name.recode.vcf
Output format: GESTE/Bayescan
Output file: bayescan_result (i think... use a more informative name nxt time)

Press convert - comes up with a little screen where you can add a metadata file with pop IDs and pop assignments
- no headers, txt file
```

```
#!/bin/bash -e
#SBATCH --job-name=bayescombined # Job name (shows up in the queue)
#SBATCH --time=8:00:00      # Walltime (HH:MM:SS) 48h
#SBATCH --mem=16G            # Memory in MB
#SBATCH --account=uoo02831
#SBATCH --cpus-per-task=4

module purge

module load BayeScan

bayescan_2.1 \
	-threads 4 \
	maskedcombined_geste.txt

echo "bayescan finished
```

## load into R - make some plots and stuff

[all_samples_bayescan_processing.Rmd](all_samples_bayescan_processing.Rmd)

for this I needed a metadata file with the CHROM, POS, AND SNP ID columns from my VCF file so I could figure out which SNP is which in my FSoutput which has all of the snps in the same order so I did:

```
grep -v "#" maskedrefiltered_maf.recode.vcf | cut -f 1,2,3 > maskedgenome_bayescan_positions.txt
```

```
vcftools --vcf maskedrefiltered_maf.recode.vcf --out combined_bayescan_significant_snps --positions significant_snps_chrom_positions.txt --recode
```
this is the final vcf with only the sig snps

for some reason tassel wont read this so I also sorted it with BCFtools

```
module load BCFtools
```
```
vcf-sort combined_bayescan_significant_snps.recode.vcf > final_combined_bayescan_significant_snps.recode.vcf
```

then have a new VCF with only the significant positions i can save and also can view graphically
![image](https://github.com/user-attachments/assets/1df8ccb7-1dbe-4a1f-9d7b-a8a2437128f0)







